sh_test(
    name = "ct",
    srcs = ["@com_google_cel_spec//tests:conftest.sh"],
    args = [
        "$(location @com_google_cel_spec//tests/simple:simple_test)",
        "--server=$(location //server/main:cel_server)",
        "--skip_test=basic/variables/self_eval_unbound_lookup",
        "--skip_test=comparisons/in_map_literal/key_in_mixed_key_type_map_error",
        "--skip_test=fields/qualified_identifier_resolution/map_key_float,map_key_null,map_value_repeat_key",
        "--skip_test=integer_math/int64_math/int64_overflow_positive,int64_overflow_negative,uint64_overflow_positive,uint64_overflow_negative",
        "$(location @com_google_cel_spec//tests/simple:testdata/plumbing.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/basic.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/comparisons.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/fields.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/fp_math.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/integer_math.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/lists.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/logic.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/macros.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/proto2.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/proto3.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/string.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/timestamps.textproto)",
    ],
    data = [
        "@com_google_cel_spec//tests/simple:simple_test",
        "//server/main:cel_server",
        "@com_google_cel_spec//tests/simple:testdata/plumbing.textproto",
        "@com_google_cel_spec//tests/simple:testdata/basic.textproto",
        "@com_google_cel_spec//tests/simple:testdata/comparisons.textproto",
        "@com_google_cel_spec//tests/simple:testdata/fields.textproto",
        "@com_google_cel_spec//tests/simple:testdata/fp_math.textproto",
        "@com_google_cel_spec//tests/simple:testdata/integer_math.textproto",
        "@com_google_cel_spec//tests/simple:testdata/lists.textproto",
        "@com_google_cel_spec//tests/simple:testdata/logic.textproto",
        "@com_google_cel_spec//tests/simple:testdata/macros.textproto",
        "@com_google_cel_spec//tests/simple:testdata/proto2.textproto",
        "@com_google_cel_spec//tests/simple:testdata/proto3.textproto",
        "@com_google_cel_spec//tests/simple:testdata/string.textproto",
        "@com_google_cel_spec//tests/simple:testdata/timestamps.textproto",
    ],
)

# ct_dashboard is a target for the conformance dashboard and includes all simple textproto files, including those that are broken.
sh_test(
    name = "ct_dashboard",
    srcs = ["@com_google_cel_spec//tests:conftest-nofail.sh"],
    args = [
        "$(location @com_google_cel_spec//tests/simple:simple_test)",
        "--server=$(location //server/main:cel_server)",
        "-test.v",
        # Failing due to a GCB builder issue
        "--skip_test=timestamps/timestamp_selectors_tz/getDate,getDayOfMonth_name_neg,getDayOfMonth_name_pos,getDayOfYear,getMinutes",
        "$(location @com_google_cel_spec//tests/simple:testdata/plumbing.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/basic.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/comparisons.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/fields.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/fp_math.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/integer_math.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/lists.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/logic.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/macros.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/proto2.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/proto3.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/string.textproto)",
        "$(location @com_google_cel_spec//tests/simple:testdata/timestamps.textproto)",
    ],
    data = [
        "@com_google_cel_spec//tests/simple:simple_test",
        "//server/main:cel_server",
        "@com_google_cel_spec//tests/simple:testdata/plumbing.textproto",
        "@com_google_cel_spec//tests/simple:testdata/basic.textproto",
        "@com_google_cel_spec//tests/simple:testdata/comparisons.textproto",
        "@com_google_cel_spec//tests/simple:testdata/fields.textproto",
        "@com_google_cel_spec//tests/simple:testdata/fp_math.textproto",
        "@com_google_cel_spec//tests/simple:testdata/integer_math.textproto",
        "@com_google_cel_spec//tests/simple:testdata/lists.textproto",
        "@com_google_cel_spec//tests/simple:testdata/logic.textproto",
        "@com_google_cel_spec//tests/simple:testdata/macros.textproto",
        "@com_google_cel_spec//tests/simple:testdata/proto2.textproto",
        "@com_google_cel_spec//tests/simple:testdata/proto3.textproto",
        "@com_google_cel_spec//tests/simple:testdata/string.textproto",
        "@com_google_cel_spec//tests/simple:testdata/timestamps.textproto",
    ],
)

